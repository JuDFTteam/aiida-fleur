

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FleurinpData &mdash; Fleur plugin 0.27 beta documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Fleur plugin 0.27 beta documentation" href="../index.html"/>
        <link rel="up" title="Fleur-plugin" href="fleur_plugin.html"/>
        <link rel="next" title="Description" href="fleurcode_plugin.html"/>
        <link rel="prev" title="Description" href="inpgen_plugin.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fleur plugin
          

          
          </a>

          
            
            
              <div class="version">
                0.27 beta
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="fleur_plugin.html">Fleur-plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fleur_plugin.html#fleur-inpgen-plugin">Fleur inpgen plugin</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="fleur_plugin.html#fleur-input-datastructure">Fleur input Datastructure</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">FleurinpData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#description-features">Description/Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-methods">User Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#comments">Comments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fleurinpmodifier">Fleurinpmodifier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">User Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-graphs">Node graphs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fleur_plugin.html#fleur-code-plugin">Fleur-code plugin</a></li>
</ul>
</li>
</ul>
<ul class="simple">
</ul>
<ul class="simple">
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Plug-in Classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Fleur plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="fleur_plugin.html">Fleur-plugin</a> &raquo;</li>
      
    <li>FleurinpData</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/plugin/fleurinp_data.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fleurinpdata">
<h1>FleurinpData<a class="headerlink" href="#fleurinpdata" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description-features">
<h2>Description/Features<a class="headerlink" href="#description-features" title="Permalink to this headline">¶</a></h2>
<a class="reference internal image-reference" href="../_images/fleurinpdata.png"><img alt="../_images/fleurinpdata.png" class="align-center" src="../_images/fleurinpdata.png" style="width: 50%; height: 300px;" /></a>
<p>FleurinpData is a new AiiDA data structure which represents everything a Fleur calculation needs, which is mainly the inp.xml file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently, Fleurinp supports ONLY inp.xml files, which have everything in them (kpoints, energy parameters, ...), i.e which were created with the &#8216;-explicit&#8217; inpgen command line switch. In general it was designed to account for several separate files too, but this is no yet supported.</p>
</div>
<p>FleurinpData was written to make the plug-in user friendlier, hide complexity and ensure the connection to AiiDA data structures (StructureData, KpointsData).
For more detailed information about the methods check the module code documentation (link).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For changing the input file use the Fleurinpmodifier class, because a new FleurinpData object has to be stored in the Database which will be linked in the database over a workfunction to the parent FleurinpData.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Initialization:</p>
</div>
<p>import FleurinpData</p>
<p>F = FleurinpData(&#8216;path_to_inp.xml_file&#8217;)
or F = FleurinpData(files=[&#8216;path_to_inp.xml_file&#8217;, (some other files)])</p>
<p>Also be aware that the inp.xml file name has to be &#8216;inp.xml&#8217;, i.e. no file names are changed,
the files will be given with the provided name to Fleur (so far).
Also if you add an other inp.xml file the first one will be overwritten.</p>
</div>
<div class="section" id="properties">
<h2>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>inp_dict <span class="classifier-delimiter">:</span> <span class="classifier">Returns the inp_dict (the representation of the inp.xml file) as it will</span></dt>
<dd>or is stored in the database.</dd>
</dl>
<p>files : Returns the files, which were added to FleurinpData.</p>
<p>_schema_file_path : Returns the absolute path of the xml schema file used for the current inp.xml file.</p>
</div>
<div class="section" id="user-methods">
<h2>User Methods<a class="headerlink" href="#user-methods" title="Permalink to this headline">¶</a></h2>
<p>get_file_abs_path(&#8216;filename&#8217;) : Returns the absolute path on the disk of a file belonging to FleurinpData.
del_file(&#8216;filename&#8217;) : Deletes a file form FleurinpData.
set_file(&#8216;path_to_file&#8217;) : Adds a file to FleurinpData.
set_files(list_of_paths_to_files) : Adds several files to FleurinpData.
get_fleur_modes() : Retrieve information from the inp.xml file. &#8216;Modes&#8217; are paths a FLEUR</p>
<blockquote>
<div>calculation can take, resulting in different output files, dependent on the input.
i.e other files need to be copied before and after the calculation. (used by the parsers)
common modes are: scf, jspin 2, dos, band, pot8, lda+U, eels, ...
(Warning, currently not auto supported by the plugin are lda+U, &#8216;magnetism&#8217;, eels )</div></blockquote>
<dl class="docutils">
<dt>(wf) get_structuredata(fleurinp) <span class="classifier-delimiter">:</span> <span class="classifier">Workfunction, which returns an AiiDA Structure Data type extracted from the inp.xml</span></dt>
<dd>file. It this was done before, it returns the existing structure data node (TODO)</dd>
<dt>(wf) get_kpointsdata(fleurinp) <span class="classifier-delimiter">:</span> <span class="classifier">workfunction,         This routine returns an AiiDA kpoint Data type produced from the inp.xml</span></dt>
<dd>file. This only works if the kpoints are listed in the in inpxml.</dd>
</dl>
<p>(wf) get_parameterdata(fleurinp) : (not implented yet) workfunction that extracts a ParameterData note, which can be an input for inpgen, out of the inp.xml
(wf) set_kpointsdata(fleurinp, kpointsdata) : This workfunction writes the all the kpoints from a KpointsDataNode in the</p>
<blockquote>
<div>inp.xml file as a kpointslist and return a new FleurinData. It replaces the Kpoints written in the
inp.xml file.
Currently, it is the users resposibility to provide a full
KpointsDataNode with weights. In the future FLEUR might recalculate them.
(ans should be moved to FleurinpModifier)</div></blockquote>
</div>
<div class="section" id="comments">
<h2>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h2>
<p>FleurinpData will serach rekursively for matching Fleur xml schema files in your PYTHONPATH and the current directory.
If you installed the plugin with pip there should be no Problem, otherwise source a folder with the schemafiles in your path.
If the search takes to long (os.walk) your pythonpath contains many directories, and you should move the plugin dirs to the front of your PYTHONPATH.
&#8216;Imergency Hack&#8217;: add a path to the &#8216;_search_paths&#8217; variable&#8217;
(In the future there might be a method use_schema, to force the use of a certain schema.)</p>
</div>
</div>
<div class="section" id="fleurinpmodifier">
<h1>Fleurinpmodifier<a class="headerlink" href="#fleurinpmodifier" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The Fleurinpmodifier class has to be used if you want to change anything on a Fleurinpdata. It will store and validate all the changes you which to do and produce a new fleurinpdata node after you are done making changes and apply them.</p>
<p>FleurinpDataModifier provides the user with methods to change the Fleur input. (not every possible change is supported, some changes are forbidden, others will be supported in the future).
In principal the user can do everything, since he could prepare a fleur input himself, and create a FleurinpData object from that input.</p>
<p>Why?
In the open provanence model no data to data links exists and nodes once stored in the database cannot be changed anymore (except extras and comments). Therefore to modify something in the inp.xml file one has to create a new FleurinpData which is not stored, modify it and store it again. But this node would pop unlinked into existence in the database and these would mean we loose the origin from what data it comes from and what was done to it. This is the task of Fleurinpmodifier.</p>
</div>
<div class="section" id="usage">
<h2>Usage:<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>One creates a Fleurinpmodifier with a FleurinpData object (1). Now the user can perform certain modifications which will be cached and can be previewed(2-3). They will only be applied on a new FleurinpData object when the freeze method is executed(4).
code example</p>
</div>
<div class="section" id="id1">
<h2>User Methods<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>General methods:</p>
<p>validate() : Test if the changes in the queue validate
freeze() : Applies all the changes in the queue (calls the workfunction &#8216;modify_fleurinpdata&#8217;) and returns a new fleurinpdata object
changes() : Displays the current queue of changes
show(display=True, validate=False) :  Test applies the modifications and displayes/prints the resulting inp.xml file.</p>
<p>Change methods:</p>
<p>xml_set_attribv_occ(xpathn, attributename, attribv, occ=[0], create=False) :
xml_set_first_attribv(self, xpathn, attributename, attribv, create=False) :
xml_set_all_attribv(self, xpathn, attributename, attribv, create=False) :
xml_set_text(self, xpathn, text, create=False) :
xml_set_all_text(self, xpathn, text, create=False) :
create_tag(self, xpath, newelement, create=False) :
delete_att(self, xpath, attrib) :
delete_tag(self, xpath) :
replace_tag(self, xpath, newelement) :
set_species(self, species_name, attributedict, create=False) :
set_atomgr_att(self, attributedict, position=None, species=None,create=False) :
#for now
set_inpchanges(self, change_dict) :
set_nkpts(self, count, gamma=&#8217;F&#8217;) :</p>
</div>
<div class="section" id="node-graphs">
<h2>Node graphs<a class="headerlink" href="#node-graphs" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>After any modification was applied to fleurinpData the following nodes will be found in the database to keep the Provenance</li>
<li>extract kpoints</li>
<li>extract structuredata</li>
<li>extract parameterdata(planned)</li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fleurcode_plugin.html" class="btn btn-neutral float-right" title="Description" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="inpgen_plugin.html" class="btn btn-neutral" title="Description" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jens Broeder.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.27 beta',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>