

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Description &mdash; Fleur plugin 0.27 beta documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Fleur plugin 0.27 beta documentation" href="../index.html"/>
        <link rel="up" title="Fleur-plugin" href="fleur_plugin.html"/>
        <link rel="next" title="Plug-in Classes" href="../code.html"/>
        <link rel="prev" title="FleurinpData" href="fleurinp_data.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fleur plugin
          

          
          </a>

          
            
            
              <div class="version">
                0.27 beta
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="fleur_plugin.html">Fleur-plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fleur_plugin.html#fleur-inpgen-plugin">Fleur inpgen plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="fleur_plugin.html#fleur-input-datastructure">Fleur input Datastructure</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="fleur_plugin.html#fleur-code-plugin">Fleur-code plugin</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-codes">Supported codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sketch-of-nodes">Sketch of nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inputs">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#outputs">Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errors">Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-advanced-features">Additional advanced features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-command-line-options">Adding command-line options</a></li>
<li class="toctree-l4"><a class="reference internal" href="#retrieving-more-files">Retrieving more files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#retrieving-less-files">Retrieving less files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#copy-more-files-remotely">Copy more files remotely</a></li>
<li class="toctree-l4"><a class="reference internal" href="#copy-less-files-remotely">Copy less files remotely</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#not-supported-code-features">Not supported code features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#partially-supported-yet">partially supported yet</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="simple">
</ul>
<ul class="simple">
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code.html">Plug-in Classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Fleur plugin</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="fleur_plugin.html">Fleur-plugin</a> &raquo;</li>
      
    <li>Description</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/plugin/fleurcode_plugin.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="description">
<h1>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h1>
<p>Use the plugin to support inputs of the Fleur code i.e. the &#8216;fleur&#8217; and &#8216;fleur_MPI&#8217; executable.</p>
</div>
<div class="section" id="supported-codes">
<h1>Supported codes<a class="headerlink" href="#supported-codes" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>tested from Fleur v0.27 (MAX release 1.0) onwards. It is NOT back compatible to
version v0.26 and earlier, because the I/O has changed completely and the plugin
relies on the xml I/O.</li>
</ul>
</div>
<div class="section" id="sketch-of-nodes">
<h1>Sketch of nodes<a class="headerlink" href="#sketch-of-nodes" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../_images/fleur_calc.png"><img alt="../_images/fleur_calc.png" class="align-center" src="../_images/fleur_calc.png" style="width: 60%; height: 300px;" /></a>
</div>
<div class="section" id="inputs">
<h1>Inputs<a class="headerlink" href="#inputs" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><strong>fleurinp</strong>, class <a class="reference internal" href="../code.html#module-aiida.orm.data.fleurinp" title="aiida.orm.data.fleurinp"><tt class="xref py py-class docutils literal"><span class="pre">fleurinpData</span></tt></a>
Data structure which represents the inp.xml file everything a Fleur calculation needs.
For more information see fleurinpData.</li>
<li><strong>parent_folder</strong>, class <tt class="xref py py-class docutils literal"><span class="pre">RemoteData</span></tt> (optional)
If specified, certain files in the scratch folder coming from a previous Fleur calculation is
copied in the scratch of the new calculation.</li>
</ul>
</div>
<div class="section" id="outputs">
<h1>Outputs<a class="headerlink" href="#outputs" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><strong>fleurinp</strong>, class <a class="reference internal" href="../code.html#module-aiida.orm.data.fleurinp" title="aiida.orm.data.fleurinp"><tt class="xref py py-class docutils literal"><span class="pre">fleurinpData</span></tt></a> (optional)
Data structure that represents the inp.xml file and provides useful methods.
For more information see fleurinpData. (accessed by ‘’calculation.out.fleurinp’’)
This will only be created if the crystal structure was changed during the fleur run.</li>
<li><strong>output_parameters</strong> class <tt class="xref py py-class docutils literal"><span class="pre">ParameterData</span></tt>
(accessed by <tt class="docutils literal"><span class="pre">calculation.res</span></tt>)
Most important output node, contains all kinds of information of the calculation
and some physical quantities of the last iterations.
The node design was chooses along the output node for the pw.x AiiDA plugin from
quantum espresso.</li>
</ul>
<dl class="docutils">
<dt>an example output node:</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;bandgap&quot;</span><span class="p">:</span> <span class="mf">0.0030463507</span><span class="p">,</span> 
  <span class="s">&quot;bandgap_units&quot;</span><span class="p">:</span> <span class="s">&quot;eV&quot;</span><span class="p">,</span> 
  <span class="s">&quot;charge_den_xc_den_integral&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">67.639951907</span><span class="p">,</span> 
  <span class="s">&quot;charge_density&quot;</span><span class="p">:</span> <span class="mf">0.0108352353</span><span class="p">,</span> 
  <span class="s">&quot;creator_name&quot;</span><span class="p">:</span> <span class="s">&quot;fleur 27&quot;</span><span class="p">,</span> 
  <span class="s">&quot;creator_target_architecture&quot;</span><span class="p">:</span> <span class="s">&quot;APC&quot;</span><span class="p">,</span> 
  <span class="s">&quot;creator_target_structure&quot;</span><span class="p">:</span> <span class="s">&quot;noInversionSymmetry noSpinOrbitCoupling&quot;</span><span class="p">,</span> 
  <span class="s">&quot;density_convergence_units&quot;</span><span class="p">:</span> <span class="s">&quot;me/bohr^3&quot;</span><span class="p">,</span> 
  <span class="s">&quot;energy&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">45035.9176561889</span><span class="p">,</span> 
  <span class="s">&quot;energy_core_electrons&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">947.8295363381</span><span class="p">,</span> 
  <span class="s">&quot;energy_hartree&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1655.0394611685</span><span class="p">,</span> 
  <span class="s">&quot;energy_hartree_units&quot;</span><span class="p">:</span> <span class="s">&quot;Htr&quot;</span><span class="p">,</span> 
  <span class="s">&quot;energy_units&quot;</span><span class="p">:</span> <span class="s">&quot;eV&quot;</span><span class="p">,</span> 
  <span class="s">&quot;energy_valence_electrons&quot;</span><span class="p">:</span> <span class="mf">2.3069313214</span><span class="p">,</span> 
  <span class="s">&quot;fermi_energy&quot;</span><span class="p">:</span> <span class="mf">0.319529563</span><span class="p">,</span> 
  <span class="s">&quot;fermi_energy_units&quot;</span><span class="p">:</span> <span class="s">&quot;Htr&quot;</span><span class="p">,</span> 
  <span class="s">&quot;number_of_atom_types&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
  <span class="s">&quot;number_of_atoms&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
  <span class="s">&quot;number_of_iterations&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> 
  <span class="s">&quot;number_of_iterations_total&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> 
  <span class="s">&quot;number_of_kpoints&quot;</span><span class="p">:</span> <span class="mi">455</span><span class="p">,</span> 
  <span class="s">&quot;number_of_species&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
  <span class="s">&quot;number_of_spin_components&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
  <span class="s">&quot;number_of_symmetries&quot;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span> 
  <span class="s">&quot;output_file_version&quot;</span><span class="p">:</span> <span class="s">&quot;0.27&quot;</span><span class="p">,</span> 
  <span class="s">&quot;outputfile_path&quot;</span><span class="p">:</span> <span class="s">&quot;/Users/broeder/aiida/.aiida/repository/repository/node/1e/01/b085-b975-4e1d-a5ea-5569a20a09d5/path/./out.xml&quot;</span><span class="p">,</span> 
  <span class="s">&quot;parser_info&quot;</span><span class="p">:</span> <span class="s">&quot;AiiDA Fleur Parser v0.1beta&quot;</span><span class="p">,</span> 
  <span class="s">&quot;parser_warnings&quot;</span><span class="p">:</span> <span class="p">[],</span> 
  <span class="s">&quot;sum_of_eigenvalues&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">945.5226050167</span><span class="p">,</span> 
  <span class="s">&quot;title&quot;</span><span class="p">:</span> <span class="s">&quot;Cu, fcc copper, bulk, delta project&quot;</span><span class="p">,</span> 
  <span class="s">&quot;unparsed&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The &#8216;simple&#8217; output node will evolve. A draft of a second complexer output node which contains informations of all iterations and atomtypes exists, but a dictionary is not the optimal structure for this. For now this is postponed. In any case if you want to parse something from the out.xml checkout the methods in xml_util.</p>
</div>
</div>
<div class="section" id="errors">
<h1>Errors<a class="headerlink" href="#errors" title="Permalink to this headline">¶</a></h1>
<p>Errors of the parsing are reported in the log of the calculation (accessible
with the <tt class="docutils literal"><span class="pre">verdi</span> <span class="pre">calculation</span> <span class="pre">logshow</span></tt> command).
Everything that Fleur writes into stderr is shown here, i.e all JuDFT error messages.</p>
<p>Moreover, all warnings and errors written by Fleur in the out.xml file are stored in the ParameterData under the key <tt class="docutils literal"><span class="pre">warnings</span></tt>, and are accessible with <tt class="docutils literal"><span class="pre">Calculation.res.warnings</span></tt>.</p>
</div>
<div class="section" id="additional-advanced-features">
<h1>Additional advanced features<a class="headerlink" href="#additional-advanced-features" title="Permalink to this headline">¶</a></h1>
<p>In general see the Fleur documenation: www.flapw.de</p>
<p>While the input link with name &#8216;fleurinpdata&#8217; is used for the content of the
inp.xml, additional parameters for changing the plugin behavior, can be specified in the &#8216;settings&#8217; input,
also of type ParameterData.</p>
<p>Below we summarise some of the options that you can specify, and their effect.
In each case, after having defined the content of <tt class="docutils literal"><span class="pre">settings_dict</span></tt>, you can use
it as input of a calculation <tt class="docutils literal"><span class="pre">calc</span></tt> by doing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">calc</span><span class="o">.</span><span class="n">use_settings</span><span class="p">(</span><span class="n">ParameterData</span><span class="p">(</span><span class="nb">dict</span><span class="o">=</span><span class="n">settings_dict</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="adding-command-line-options">
<h2>Adding command-line options<a class="headerlink" href="#adding-command-line-options" title="Permalink to this headline">¶</a></h2>
<p>If you want to add command-line options to the executable (particularly
relevant e.g. &#8216;-hdf&#8217; use hdf, or &#8216;-magma&#8217; use different libaries, magma in this case) (see fleur -h or www.flapw.de), you can pass each option
as a string in a list, as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;cmdline&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;-hdf&#39;</span><span class="p">,</span> <span class="s">&#39;-magma&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default command-line of a fleur execution of the plugin looks like this for the torque scheduler:</p>
<div class="highlight-python"><div class="highlight"><pre>&#39;mpirun&#39; &#39;-np&#39; &#39;XX&#39; &#39;path_to_fleur_executable&#39; &#39;-xmlInput&#39; &#39;-wtime&#39; &#39;XXXXX&#39; &lt; &#39;inp.xml&#39; &gt; &#39;shell.out&#39; 2&gt; &#39;out.error&#39;
</pre></div>
</div>
</div>
<div class="section" id="retrieving-more-files">
<h2>Retrieving more files<a class="headerlink" href="#retrieving-more-files" title="Permalink to this headline">¶</a></h2>
<p>The plugin retrieves per default the files : out.xml, out, cdn1 and inp.xml.
This way continuing a Fleur calculation from the repository is per default possible.
When certain inputs are given the plugin retrieves also the files:
* if band=T : bands.1, bands.2
* if dos=T: DOS.1, DOS.2
* if pot8=T : pot*
...</p>
<p>If you know that your calculation is producing additional files that you want to
retrieve (and preserve in the AiiDA repository in the long term), you can add
those files as a list as follows (here in the case of a file named
<tt class="docutils literal"><span class="pre">testfile.txt</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;additional_retrieve_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;testfile.txt&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="retrieving-less-files">
<h2>Retrieving less files<a class="headerlink" href="#retrieving-less-files" title="Permalink to this headline">¶</a></h2>
<p>If you know that you do not want to retrieve certain files(and preserve in the AiiDA repository in the long term). i.e. the cdn1 file is to large and it is stored somewhere else anyway, you can add
those files as a list as follows (here in the case of a file named
<tt class="docutils literal"><span class="pre">testfile.txt</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;remove_from_retrieve_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;testfile.txt&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="copy-more-files-remotely">
<h2>Copy more files remotely<a class="headerlink" href="#copy-more-files-remotely" title="Permalink to this headline">¶</a></h2>
<p>The plugin copies per default the broyden files (broyd*) if a parent_folder is given in the input.</p>
<p>If you know that for your calculation you need some other files on the remote machine, you can add
those files as a list as follows (here in the case of a file named
<tt class="docutils literal"><span class="pre">testfile.txt</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;additional_remotecopy_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;testfile.txt&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="copy-less-files-remotely">
<h2>Copy less files remotely<a class="headerlink" href="#copy-less-files-remotely" title="Permalink to this headline">¶</a></h2>
<p>If you know that for your calculation do not need some files which are copied per default by the plugin you can add those files as a list as follows (here in the case of a file named
<tt class="docutils literal"><span class="pre">testfile.txt</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;remove_from_remotecopy_list&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;testfile.txt&#39;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="not-supported-code-features">
<h1>Not supported code features<a class="headerlink" href="#not-supported-code-features" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li>sparning multiple fleur calculation with on execution of fleur in a certain subdir structure</li>
</ul>
<p>(on can parse the commandline switches, but it will fail.)</p>
<div class="section" id="partially-supported-yet">
<h2>partially supported yet<a class="headerlink" href="#partially-supported-yet" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>LDA+U, not tested yet, in principal possible, but user has to take care of copying the files, nothing parsed to output</li>
<li>Noncolinear Magnetism, not tested yet, in principal possible, but user has to take care of copying the extra files, not all information is parsed.</li>
<li>Jijs same as nonco.</li>
<li>1D, not supported by the plugin, but currently also not testest in Fleur 0.27</li>
</ul>
<p>(in principal possible, some plugin functionalities have to be updated.)</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../code.html" class="btn btn-neutral float-right" title="Plug-in Classes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fleurinp_data.html" class="btn btn-neutral" title="FleurinpData" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jens Broeder.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.27 beta',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>